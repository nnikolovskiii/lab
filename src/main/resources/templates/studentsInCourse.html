<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>


<div xmlns:th="http://www.thymeleaf.org">
    <section class="jumbotron text-center">
        <div class="container">
            <h1 class="jumbotron-heading">Students</h1>
            <h3 class="jumbotron-heading">All students</h3>
        </div>
    </section>

    <div class="container mb-4" th:if="${students.size() > 0}">
        <form th:action="@{/StudentEnrollmentSummary/lol}" th:method="POST">
            <div class="form-group">
                <label for="description">Date and time</label>
                <input type="datetime-local"
                       class="form-control"
                       id="description1"
                       name="from"
                       th:value="(${from} != null ? ${from} : '')"
                >
            </div>
            <div class="form-group">
                <label for="description">Date and time</label>
                <input type="datetime-local"
                       class="form-control"
                       id="description"
                       name="to"
                       th:value="(${to} != null ? ${to} : '')"
                >
            </div>

            <button type="submit" >Filter</button>
        </form>

        <a th:href="@{/StudentEnrollmentSummary}"
           class="btn btn-sm btn-danger delete-product">
            <i class="fa fa-trash">Show all</i>
        </a>
    </div>

    <div class="container mb-4">
        <div class="row">
            <div class="col-12" th:if="${students.size() > 0}">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th scope="col">Username</th>
                            <th scope="col">Name</th>
                            <th scope="col">Surname</th>
                            <th scope="col">Grade</th>
                            <th scope="col">Grade Entered At</th>
                            <th scope="col">Choose Action</th>

                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="student : ${students}" class="product">

                            <td th:text="${student.getUsername()}"></td>
                            <td th:text="${student.getName()}"></td>
                            <td th:text="${student.getSurname()}"></td>
                            <td th:if="${grades.containsKey(student.getUsername())}"
                                th:text="${grades.get(student.getUsername()).getGrade()}"></td>

                            <td th:if="${!grades.containsKey(student.getUsername())}">
                                No Grade
                            </td>

                            <td th:if="${grades.containsKey(student.getUsername())}"
                                th:text="${grades.get(student.getUsername()).getTimestamp()}"></td>

                            <td th:if="${!grades.containsKey(student.getUsername())}">
                                No date
                            </td>

                            <td class="text-right">
                                <!--http://localhost:8080/AddStudent?_method=DELETE-->
                                <th:block
                                        th:if="${!grades.containsKey(student.getUsername())}">
                                    <a th:href="@{'/createGrade/{studentId}' (studentId=${student.getUsername()})}"
                                       class="btn btn-secondary">
                                        <i class="fa fa-trash">Add Grade</i>
                                    </a>
                                </th:block>
                                <th:block th:if="${grades.containsKey(student.getUsername())}">
                                    <a th:href="@{'/createGrade/delete/{id}' (id=${grades.get(student.getUsername()).getId()})}"
                                       class="btn btn-sm btn-danger delete-product">
                                        <i class="fa fa-trash">Delete Grade</i>
                                    </a>
                                </th:block>
                                <th:block th:if="${grades.containsKey(student.getUsername())}">
                                    <a th:href="@{'/createGrade/edit-form/{id}' (id=${grades.get(student.getUsername()).getId()})}"
                                       class="btn btn-sm btn-info edit-product">
                                        <i class="fa fa-trash">Edit Grade</i>
                                    </a>
                                </th:block>
                            </td>




                        </tr>
                        </tbody>
                    </table>


                    </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div>
        <a th:href="@{'/AddStudent'}"
           class="btn btn-sm btn-info">
            <i class="fa fa-trash">Back</i>
        </a>
    </div>
    </div>

</div>

